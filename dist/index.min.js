!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("dayjs"),require("url-slug"),require("node-html-markdown"),require("react-papaparse"),require("lodash/isEmpty")):"function"==typeof define&&define.amd?define(["dayjs","url-slug","node-html-markdown","react-papaparse","lodash/isEmpty"],t):(e="undefined"!=typeof globalThis?globalThis:e||self)["nextjs-gdocs-cms"]=t(e.dayjs,e["url-slug"],e.NodeHtmlMarkdown,e.usePapaParse,e.isEmpty)}(this,(function(e,t,a,s,r){"use strict";function i(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=i(e),o=i(t);const d=e=>{const t=e&&e.split(/(==[a-zA-Z]{2,3}==)/gim);if(t&&!r.isEmpty(t[0]))return t[0].trim();const a={};return t&&t.forEach(((e,s)=>{const r=/(==)([a-zA-Z]{2,3})(==)/gi.test(e),i=e.replace(/==/g,"");r&&(a[i]=t[s+1].trim())})),a};return{fetchDriveList:async(e,t,a=!0)=>{const s=`https://www.googleapis.com/drive/v3/files/?q="${e}"+in+parents&orderBy=createdTime desc&fields=files(id,kind,createdTime,name,version,thumbnailLink,starred,exportLinks)&pageSize=${t}&key=${process.env.GOOGLE_API_KEY}`,r=await fetch(s),i=await r.json();return i&&i.files&&i.files.map((e=>({...e,slug:`${a?n.default(e.createdTime).format("YYYY-MM-DD-"):""}${o.default(e.name)}`})))},parseDocumentData:async e=>{if(!e)return null;const t=await fetch(e.exportLinks["text/html"]).then((e=>e.text()));return{...e,mdText:a.NodeHtmlMarkdown.translate(t,{}),html:t}},parseTableData:async e=>{const{readString:t}=s.usePapaParse(),a=await fetch(e.exportLinks["text/csv"]).then((e=>e.text())),{data:r}=await t(a);return{...e,data:r,rawCsv:a}},fetchCalendarData:async(e,t,a)=>{const s=process.env.GOOGLE_API_KEY,r=n.default(),i=`https://www.googleapis.com/calendar/v3/calendars/${e}/events?orderBy=startTime&singleEvents=true&maxResults=${a}&timeMin=${n.default().add(-1,"day").format("YYYY-MM-DDTHH:mm:ss")}Z&timeMax=${n.default().add(t,"days").format("YYYY-MM-DDTHH:mm:ss")}Z&key=${s}`,l=await fetch(i),m=await l.json(),u=m&&m.items&&m.items.filter((e=>{const t=n.default(e.end.dateTime);return n.default(e.start.dateTime)>r||t>r}));return u?u.map((e=>{return{id:e.id,slug:`${n.default(e.start.dateTime).format("YYYY-MM-DD")}-${o.default(e.summary,{camelCase:!1})}`,title:e.summary,description:d(e.description),location:e.location,locationShort:(t=e.location,t.split(",")[0]),locationGps:{},start:e.start.dateTime,end:e.end.dateTime};var t})):null},parseDescriptionText:d}}));
